<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Chapter 06 - Section 07 | Mostafa Touny</title>
<meta name="keywords" content="">
<meta name="description" content="$\newcommand{\nfrac}[2]{\frac{\displaystyle{#1}}{\displaystyle{#2}}}$
Exercises
3
Fact. Given a set $A$ of distinct elements in a random order, The positition of the maximum element of a subset $S \subset A$ is uniform in $S$.
Define indicator random variables $L_i$ as

$$
L_i =
    \begin{cases} 
        1 & a_i &gt; a_{i-1}, a_{i-2}, \dots, a_{1} \\\\
        0 & a_i &lt; a_j, \text{ for some } j = 1,2, \dots, i-1 
    \end{cases}
$$
So $L_i = 1$ if and only if the ith item $a_i$ is the maximum in subset $A[1:i]$.">
<meta name="author" content="">
<link rel="canonical" href="https://www.mostafatouny.github.io/vraj-kni-post/ch06-sec07/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.e6ee52f0fc7c2e3dbd78858fc1b3e06fb86a3c6ee38d351342e06e23a24d02d6.css" integrity="sha256-5u5S8Px8Lj29eIWPwbPgb7hqPG7jjTUTQuBuI6JNAtY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://www.mostafatouny.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.mostafatouny.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.mostafatouny.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://www.mostafatouny.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://www.mostafatouny.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://www.mostafatouny.github.io/vraj-kni-post/ch06-sec07/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="Chapter 06 - Section 07" />
<meta property="og:description" content="$\newcommand{\nfrac}[2]{\frac{\displaystyle{#1}}{\displaystyle{#2}}}$
Exercises
3
Fact. Given a set $A$ of distinct elements in a random order, The positition of the maximum element of a subset $S \subset A$ is uniform in $S$.
Define indicator random variables $L_i$ as

$$
L_i =
    \begin{cases} 
        1 & a_i &gt; a_{i-1}, a_{i-2}, \dots, a_{1} \\\\
        0 & a_i &lt; a_j, \text{ for some } j = 1,2, \dots, i-1 
    \end{cases}
$$
So $L_i = 1$ if and only if the ith item $a_i$ is the maximum in subset $A[1:i]$." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.mostafatouny.github.io/vraj-kni-post/ch06-sec07/" /><meta property="article:section" content="vraj-kni-post" />
<meta property="article:published_time" content="2024-01-08T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-01-08T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Chapter 06 - Section 07"/>
<meta name="twitter:description" content="$\newcommand{\nfrac}[2]{\frac{\displaystyle{#1}}{\displaystyle{#2}}}$
Exercises
3
Fact. Given a set $A$ of distinct elements in a random order, The positition of the maximum element of a subset $S \subset A$ is uniform in $S$.
Define indicator random variables $L_i$ as

$$
L_i =
    \begin{cases} 
        1 & a_i &gt; a_{i-1}, a_{i-2}, \dots, a_{1} \\\\
        0 & a_i &lt; a_j, \text{ for some } j = 1,2, \dots, i-1 
    \end{cases}
$$
So $L_i = 1$ if and only if the ith item $a_i$ is the maximum in subset $A[1:i]$."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Vrajitoru \u0026 Knight's Probabilistic Analysis of Algorithms",
      "item": "https://www.mostafatouny.github.io/vraj-kni-post/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Chapter 06 - Section 07",
      "item": "https://www.mostafatouny.github.io/vraj-kni-post/ch06-sec07/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Chapter 06 - Section 07",
  "name": "Chapter 06 - Section 07",
  "description": "$\\newcommand{\\nfrac}[2]{\\frac{\\displaystyle{#1}}{\\displaystyle{#2}}}$\nExercises 3 Fact. Given a set $A$ of distinct elements in a random order, The positition of the maximum element of a subset $S \\subset A$ is uniform in $S$.\nDefine indicator random variables $L_i$ as $$ L_i = \\begin{cases} 1 \u0026 a_i \u003e a_{i-1}, a_{i-2}, \\dots, a_{1} \\\\\\\\ 0 \u0026 a_i \u003c a_j, \\text{ for some } j = 1,2, \\dots, i-1 \\end{cases} $$ So $L_i = 1$ if and only if the ith item $a_i$ is the maximum in subset $A[1:i]$.\n",
  "keywords": [
    
  ],
  "articleBody": "$\\newcommand{\\nfrac}[2]{\\frac{\\displaystyle{#1}}{\\displaystyle{#2}}}$\nExercises 3 Fact. Given a set $A$ of distinct elements in a random order, The positition of the maximum element of a subset $S \\subset A$ is uniform in $S$.\nDefine indicator random variables $L_i$ as $$ L_i = \\begin{cases} 1 \u0026 a_i \u003e a_{i-1}, a_{i-2}, \\dots, a_{1} \\\\\\\\ 0 \u0026 a_i \u003c a_j, \\text{ for some } j = 1,2, \\dots, i-1 \\end{cases} $$ So $L_i = 1$ if and only if the ith item $a_i$ is the maximum in subset $A[1:i]$.\nIt follows $Pr[L_i = 1] = 1/i$ and $Ex[Li] = 1/i$.\nLet $X$ be a random variable for the number of times the line a[first] \u003e a[max_loc] returns True. Observe $X = L_2 + L_3 + \\dots + L_n$. So $Ex[X] = 1/2 + \\dots + 1/n = H(n) - 1 \\approx \\ln n - 1$.\n$H(n)$ here is the nth harmonic sum.\n4 a Note. Our solution was initially flawed until we read the description of exercise 6 which gave the correct answer. We only reconstructred the proof given the answer.\nFact 1. On the ith step of the first pass of bubble-sort, $A[i]$ is the maximum element among $A[0:i]$.\nFact 2. Given $A$ is a set of distinct elements in a random order, The probability of $A[i]$ being the maximum element of $A[0:i]$ is $\\frac{\\displaystyle{1}}{\\displaystyle{i+1}}$.\nLet $R_i$ be an indicator random variable, Indicating whether $A[i] \u003e A[i+1]$, at the ith step of the loop. From Fact 1, $R_i = 1$ if and only if $A[i+1]$ is not the maximum among $A[0:i+1]$. The probability of that event is $\\frac{\\displaystyle{i+1}}{\\displaystyle{i+2}}$ from Fact 2.\nClearly $Ex[R_i] = \\frac{\\displaystyle{i+1}}{\\displaystyle{i+2}}$. It follows $W = \\sum_{i=0}^{n-2} R_i = \\frac{\\displaystyle{1}}{\\displaystyle{2}} + \\frac{\\displaystyle{2}}{\\displaystyle{3}} + \\dots + \\frac{\\displaystyle{n-1}}{\\displaystyle{n}} = (n-1) - \\left ( \\nfrac{1}{2} + \\nfrac{1}{3} + \\dots + \\nfrac{1}{n} \\right ) = n - 1 - H_n + 1 \\approx n - \\lg n$.\nb That event happens if and only if\n$max(A[1], A[2]) \u003c A[3]$. Its probability is $\\frac{\\displaystyle{2}}{\\displaystyle{3}}$. Or $max(A[1], A[2]) \u003e A[3]$ and $A[1] \u003c A[3]$. Its probability is $\\frac{\\displaystyle{1}}{\\displaystyle{3}} \\cdot \\frac{\\displaystyle{1}}{\\displaystyle{2}} = \\frac{\\displaystyle{1}}{\\displaystyle{6}}$. So the probability $A[1] \u003c A[2]$ after the first pass of bubble-sort is $\\frac{\\displaystyle{2}}{\\displaystyle{3}} + \\frac{\\displaystyle{1}}{\\displaystyle{6}} = \\frac{\\displaystyle{4}}{\\displaystyle{6}} = \\frac{\\displaystyle{2}}{\\displaystyle{3}}$.\n5 Fact. Given a randomly ordered $A$, Any $A[:K]$ is also randomly ordered.\nFact. Uniformly $A[k] \\in \\{ q_1, q_2, \\dots, q_k \\}$ where $q_i \\in A[:k]$ and $q_1 \u003e q_2 \u003e \\dots \u003e q_k$.\nIn kth iteration, $A[1:k-1]$ is sorted, and $A[k]$ will be uniformly displaced to\nposition $k, k-1, \\dots, 1$. Respectively, #comparisons $= 1,2, \\dots, k$. Respectively, #assignments $= 0, 1, \\dots, k-1$. Denote total number of comparisons by $C$ and comparisons in kth iteration by $C_k$. Similarly $A$ and $A_k$ for assignments. In expectation \\begin{aligned} Ex[C_k] \u0026= \\nfrac{1}{k} (1 + \\dots + k) = \\nfrac{1}{k} \\nfrac{k \\cdot k+1}{2} = \\nfrac{k+1}{2} \\\\ Ex[A_k] \u0026= \\nfrac{1}{k} (1 + \\dots + k-1) = \\nfrac{1}{k} \\nfrac{(k-1)k}{2} = \\nfrac{k-1}{2} \\end{aligned} Clearly $C = \\sum_{k=2}^n C_k$ and $A = \\sum_{k=2}^n A_k$. So \\begin{aligned} Ex[C] \u0026= \\sum_{k=2}^n \\nfrac{k+1}{2} \\\\ \u0026= \\nfrac{1}{2} \\sum_{k=2}^n k+1 \\\\ \u0026= \\nfrac{1}{2} \\left [ ( \\sum_{k=1}^{n+1} k) - 1 - 2 \\right ] \\\\ \u0026= \\nfrac{1}{2} \\left [ \\nfrac{(n+1)(n+2)}{2} - 3 \\right ] \\\\ \u0026= \\nfrac{(n+1)(n+2)}{4} - \\nfrac{3}{2} \\\\ Ex[A] \u0026= \\sum_{k=2}^n \\nfrac{k-1}{2} \\\\ \u0026= \\nfrac{1}{2} \\sum_{k=2}^n k-1 \\\\ \u0026= \\nfrac{1}{2} \\sum_{k=1}^{n-1} k \\\\ \u0026= \\nfrac{1}{2} \\nfrac{n(n-1)}{2} \\\\ \u0026= \\nfrac{n(n-1)}{4} \\end{aligned}\n6 The fact $Ex[W_n] = n - H(n)$ rests on the assumption array $A$ is randomly ordered. That is not the case after the first pass. This is clear from our answer in Ex. 4, b.\n9 Fact 1. The number of comparisons took by the algorithm is decided by the smaller-position target.\nFact 2. Given $A$ is randomly ordered, target $t_1$ is uniform among all $n$ positions, and target $t_2$ is uniform among all remaining $n-1$ positions.\nFact 3. Since we are operating on remaining $n-1$ positions, The choice of $t_1$ is irrelevant. In other words the two events independent.\nLet $R$ be the number of algorithmâ€™s comparisons. Let $W$ be the position of smaller-position target. By Fact 1 $R = W+1$. Observe $Pr[W=0] = Pr[R=1] = \\frac{\\displaystyle{1}}{\\displaystyle{n}} \\cdot \\frac{\\displaystyle{n-1}}{\\displaystyle{n-1}}$, $Pr[W=1] = Pr[R=2] = \\frac{\\displaystyle{1}}{\\displaystyle{n}} \\cdot \\frac{\\displaystyle{n-2}}{\\displaystyle{n-1}}$\nGenerally, for $k \\in \\{ 0, 1, \\dots, n-1 \\}$, $Pr[R=k] = \\frac{\\displaystyle{n-k}}{\\displaystyle{n-1}}$. So by definition, \\begin{aligned} Ex[R] \u0026= \\sum_{k=1}^{n-1} i \\cdot \\frac{\\displaystyle{1}}{\\displaystyle{n}} \\cdot \\frac{\\displaystyle{n-i}}{\\displaystyle{n-1}} \\\\ \u0026= \\frac{\\displaystyle{1}}{\\displaystyle{n}} \\cdot \\frac{\\displaystyle{1}}{\\displaystyle{n-1}} \\sum_{i=1}^{n-1} i (n-i) \\\\ \u0026= \\frac{\\displaystyle{1}}{\\displaystyle{n}} \\cdot \\frac{\\displaystyle{1}}{\\displaystyle{n-1}} \\left ( n \\sum_{i=1}^{n-1} i - \\sum_{i=1}^{n-1} i^2 \\right ) \\\\ \u0026= \\frac{\\displaystyle{1}}{\\displaystyle{n}} \\cdot \\frac{\\displaystyle{1}}{\\displaystyle{n-1}} \\left ( n \\frac{\\displaystyle{n(n-1)}}{\\displaystyle{2}} - \\frac{\\displaystyle{(n-1)n(2n-1)}}{\\displaystyle{6}} \\right ) \\\\ \u0026= \\frac{\\displaystyle{3n}}{\\displaystyle{6}} - \\frac{\\displaystyle{2n-1}}{\\displaystyle{6}} = \\frac{\\displaystyle{n+1}}{\\displaystyle{6}} \\end{aligned}\n",
  "wordCount" : "764",
  "inLanguage": "en",
  "datePublished": "2024-01-08T00:00:00Z",
  "dateModified": "2024-01-08T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://www.mostafatouny.github.io/vraj-kni-post/ch06-sec07/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Mostafa Touny",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.mostafatouny.github.io/favicon.ico"
    }
  }
}
</script>

    
    
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<script>
  MathJax = {
    tex: {
      displayMath: [ ['$$', '$$'], ['\\[', '\\]'] ],  
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ]      
    }
  };
</script>

    
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://www.mostafatouny.github.io/" accesskey="h" title="Mostafa Touny (Alt + H)">Mostafa Touny</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://www.mostafatouny.github.io/about" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://www.mostafatouny.github.io/post" title="Blog">
                    <span>Blog</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Chapter 06 - Section 07
    </h1>
    <div class="post-meta"><span title='2024-01-08 00:00:00 +0000 UTC'>January 8, 2024</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#exercises" aria-label="Exercises">Exercises</a><ul>
                        
                <li>
                    <a href="#section" aria-label="3">3</a></li>
                <li>
                    <a href="#section-1" aria-label="4">4</a><ul>
                        
                <li>
                    <a href="#a" aria-label="a">a</a></li>
                <li>
                    <a href="#b" aria-label="b">b</a></li></ul>
                </li>
                <li>
                    <a href="#section-2" aria-label="5">5</a></li>
                <li>
                    <a href="#6" aria-label="6">6</a></li>
                <li>
                    <a href="#9" aria-label="9">9</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>$\newcommand{\nfrac}[2]{\frac{\displaystyle{#1}}{\displaystyle{#2}}}$</p>
<h2 id="exercises" class="unnumbered">Exercises<a hidden class="anchor" aria-hidden="true" href="#exercises">#</a></h2>
<h3 id="section" class="unnumbered">3<a hidden class="anchor" aria-hidden="true" href="#section">#</a></h3>
<p><strong>Fact.</strong> Given a set $A$ of distinct elements in a random order, The positition of the maximum element of a subset $S \subset A$ is uniform in $S$.</p>
<p>Define indicator random variables $L_i$ as
</p>
$$
L_i =
    \begin{cases} 
        1 & a_i > a_{i-1}, a_{i-2}, \dots, a_{1} \\\\
        0 & a_i < a_j, \text{ for some } j = 1,2, \dots, i-1 
    \end{cases}
$$<p>
So $L_i = 1$ if and only if the ith item $a_i$ is the maximum in subset $A[1:i]$.</p>
<p>It follows $Pr[L_i = 1] = 1/i$ and $Ex[Li] = 1/i$.</p>
<p>Let $X$ be a random variable for the number of times the line <code>a[first] &gt; a[max_loc]</code> returns <code>True</code>. Observe $X = L_2 + L_3 + \dots + L_n$. So $Ex[X] = 1/2 + \dots + 1/n = H(n) - 1 \approx \ln n - 1$.</p>
<p>$H(n)$ here is the nth harmonic sum.</p>
<h3 id="section-1" class="unnumbered">4<a hidden class="anchor" aria-hidden="true" href="#section-1">#</a></h3>
<h4 id="a" class="unnumbered">a<a hidden class="anchor" aria-hidden="true" href="#a">#</a></h4>
<p><strong>Note.</strong> Our solution was initially flawed until we read the description of <em>exercise 6</em> which gave the correct answer. We only reconstructred the proof given the answer.</p>
<p><strong>Fact 1.</strong> On the ith step of the first pass of bubble-sort, $A[i]$ is the maximum element among $A[0:i]$.</p>
<p><strong>Fact 2.</strong> Given $A$ is a set of distinct elements in a random order, The probability of $A[i]$ being the maximum element of $A[0:i]$ is $\frac{\displaystyle{1}}{\displaystyle{i+1}}$.</p>
<p>Let $R_i$ be an indicator random variable, Indicating whether $A[i] > A[i+1]$, at the ith step of the loop. From <em>Fact 1</em>, $R_i = 1$ if and only if $A[i+1]$ is not the maximum among $A[0:i+1]$. The probability of that event is $\frac{\displaystyle{i+1}}{\displaystyle{i+2}}$ from <em>Fact 2</em>.</p>
<p>Clearly $Ex[R_i] = \frac{\displaystyle{i+1}}{\displaystyle{i+2}}$. It follows $W = \sum_{i=0}^{n-2} R_i = \frac{\displaystyle{1}}{\displaystyle{2}} + \frac{\displaystyle{2}}{\displaystyle{3}} + \dots + \frac{\displaystyle{n-1}}{\displaystyle{n}} = (n-1) - \left ( \nfrac{1}{2} + \nfrac{1}{3} + \dots + \nfrac{1}{n} \right ) = n - 1 - H_n + 1 \approx n - \lg n$.</p>
<h4 id="b" class="unnumbered">b<a hidden class="anchor" aria-hidden="true" href="#b">#</a></h4>
<p>That event happens if and only if</p>
<ul>
<li>$max(A[1], A[2]) < A[3]$. Its probability is $\frac{\displaystyle{2}}{\displaystyle{3}}$. Or</li>
<li>$max(A[1], A[2]) > A[3]$ and $A[1] < A[3]$. Its probability is $\frac{\displaystyle{1}}{\displaystyle{3}} \cdot \frac{\displaystyle{1}}{\displaystyle{2}} = \frac{\displaystyle{1}}{\displaystyle{6}}$.</li>
</ul>
<p>So the probability $A[1] < A[2]$ after the first pass of bubble-sort is $\frac{\displaystyle{2}}{\displaystyle{3}} + \frac{\displaystyle{1}}{\displaystyle{6}} = \frac{\displaystyle{4}}{\displaystyle{6}} = \frac{\displaystyle{2}}{\displaystyle{3}}$.</p>
<h3 id="section-2" class="unnumbered">5<a hidden class="anchor" aria-hidden="true" href="#section-2">#</a></h3>
<p><strong>Fact.</strong> Given a randomly ordered $A$, Any $A[:K]$ is also randomly ordered.</p>
<p><strong>Fact.</strong> Uniformly $A[k] \in \{ q_1, q_2, \dots, q_k \}$ where $q_i \in A[:k]$ and $q_1 > q_2 > \dots > q_k$.</p>
<p>In kth iteration, $A[1:k-1]$ is sorted, and $A[k]$ will be uniformly displaced to</p>
<ul>
<li>position $k, k-1, \dots, 1$. Respectively,</li>
<li>#comparisons $= 1,2, \dots, k$. Respectively,</li>
<li>#assignments $= 0, 1, \dots, k-1$.</li>
</ul>
<p>Denote total number of comparisons by $C$ and comparisons in kth iteration by $C_k$. Similarly $A$ and $A_k$ for assignments. In expectation
\begin{aligned}
Ex[C_k] &amp;= \nfrac{1}{k} (1 + \dots + k) = \nfrac{1}{k} \nfrac{k \cdot k+1}{2} = \nfrac{k+1}{2} \\
Ex[A_k] &amp;= \nfrac{1}{k} (1 + \dots + k-1) = \nfrac{1}{k} \nfrac{(k-1)k}{2} = \nfrac{k-1}{2}
\end{aligned}
Clearly $C = \sum_{k=2}^n C_k$ and $A = \sum_{k=2}^n A_k$. So
\begin{aligned}
Ex[C] &amp;= \sum_{k=2}^n \nfrac{k+1}{2} \\
&amp;= \nfrac{1}{2} \sum_{k=2}^n k+1 \\
&amp;= \nfrac{1}{2} \left [ ( \sum_{k=1}^{n+1} k) - 1 - 2 \right ] \\
&amp;= \nfrac{1}{2} \left [ \nfrac{(n+1)(n+2)}{2} - 3 \right ] \\
&amp;= \nfrac{(n+1)(n+2)}{4} - \nfrac{3}{2} \\
Ex[A] &amp;= \sum_{k=2}^n \nfrac{k-1}{2} \\
&amp;= \nfrac{1}{2} \sum_{k=2}^n k-1 \\
&amp;= \nfrac{1}{2} \sum_{k=1}^{n-1} k \\
&amp;= \nfrac{1}{2} \nfrac{n(n-1)}{2} \\
&amp;= \nfrac{n(n-1)}{4}
\end{aligned}</p>
<h3 id="6">6<a hidden class="anchor" aria-hidden="true" href="#6">#</a></h3>
<p>The fact $Ex[W_n] = n - H(n)$ rests on the assumption array $A$ is randomly ordered. That is not the case after the first pass. This is clear from our answer in <em>Ex. 4, b</em>.</p>
<h3 id="9">9<a hidden class="anchor" aria-hidden="true" href="#9">#</a></h3>
<p><strong>Fact 1.</strong> The number of comparisons took by the algorithm is decided by the smaller-position target.</p>
<p><strong>Fact 2.</strong> Given $A$ is randomly ordered, target $t_1$ is uniform among all $n$ positions, and target $t_2$ is uniform among all remaining $n-1$ positions.</p>
<p><strong>Fact 3.</strong> Since we are operating on remaining $n-1$ positions, The choice of $t_1$ is irrelevant. In other words the two events independent.</p>
<p>Let $R$ be the number of algorithm&rsquo;s comparisons. Let $W$ be the position of smaller-position target. By <em>Fact 1</em> $R = W+1$. Observe $Pr[W=0] = Pr[R=1] = \frac{\displaystyle{1}}{\displaystyle{n}} \cdot \frac{\displaystyle{n-1}}{\displaystyle{n-1}}$, $Pr[W=1] = Pr[R=2] = \frac{\displaystyle{1}}{\displaystyle{n}} \cdot \frac{\displaystyle{n-2}}{\displaystyle{n-1}}$</p>
<p><img loading="lazy" src="./ex09-0.png" alt="image"  />
</p>
<p>Generally, for $k \in \{ 0, 1, \dots, n-1 \}$, $Pr[R=k] = \frac{\displaystyle{n-k}}{\displaystyle{n-1}}$. So by definition,
\begin{aligned}
Ex[R] &amp;= \sum_{k=1}^{n-1} i \cdot \frac{\displaystyle{1}}{\displaystyle{n}} \cdot \frac{\displaystyle{n-i}}{\displaystyle{n-1}} \\
&amp;= \frac{\displaystyle{1}}{\displaystyle{n}} \cdot \frac{\displaystyle{1}}{\displaystyle{n-1}} \sum_{i=1}^{n-1} i (n-i) \\
&amp;= \frac{\displaystyle{1}}{\displaystyle{n}} \cdot \frac{\displaystyle{1}}{\displaystyle{n-1}} \left ( n \sum_{i=1}^{n-1} i - \sum_{i=1}^{n-1} i^2 \right ) \\
&amp;= \frac{\displaystyle{1}}{\displaystyle{n}} \cdot \frac{\displaystyle{1}}{\displaystyle{n-1}} \left ( n \frac{\displaystyle{n(n-1)}}{\displaystyle{2}} - \frac{\displaystyle{(n-1)n(2n-1)}}{\displaystyle{6}} \right ) \\
&amp;= \frac{\displaystyle{3n}}{\displaystyle{6}} - \frac{\displaystyle{2n-1}}{\displaystyle{6}} = \frac{\displaystyle{n+1}}{\displaystyle{6}}
\end{aligned}</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://www.mostafatouny.github.io/">Mostafa Touny</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
